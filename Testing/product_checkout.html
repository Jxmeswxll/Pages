<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Complete your custom PC order with our easy 3-step checkout process.">
    <title>Checkout - Custom PC | Aftershock</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
:root {
    --primary-color: #0A84FF; /* A vibrant blue, good for "8K UI" feel */
    --primary-hover: #0070D9;
    --background-dark: #0D0D0F; /* Very dark, almost black */
    --surface-dark: #1A1A1C; /* For panels and cards */
    --surface-medium: #2C2C2E; /* Slightly lighter elements */
    --surface-light: #3A3A3C; /* Hover states or subtle borders */
    --text-primary: #F5F5F7; /* Off-white for primary text */
    --text-secondary: #A0A0A5; /* Lighter gray for secondary text */
    --text-placeholder: #6E6E73;
    --border-color: #3A3A3C;
    --error-color: #FF3B30;
    --success-color: #34C759;

    --font-main: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;

    --shadow-sm: 0 2px 8px rgba(0,0,0,0.3);
    --shadow-md: 0 6px 16px rgba(0,0,0,0.4);
    --shadow-lg: 0 12px 32px rgba(0,0,0,0.5);
    --border-radius-sm: 6px;
    --border-radius-md: 10px;
    --border-radius-lg: 16px;
    --transition-speed: 0.3s;
}

body {
    font-family: var(--font-main);
    margin: 0;
    padding: 0;
    background-color: var(--background-dark);
    color: var(--text-primary);
    line-height: 1.6;
    font-size: 16px;
    display: flex;
    justify-content: center;
    align-items: center; /* Center the container vertically */
    min-height: 100vh;
    padding: 20px; /* Padding around the main container */
    overflow-x: hidden; /* Prevent horizontal scroll from side panels */
}

.checkout-container {
    width: 100%; /* Take full width to allow side panels to peek */
    max-width: 1200px; /* Max width for the overall component */
    background-color: transparent; /* Main container is now more of a viewport controller */
    border-radius: var(--border-radius-lg);
    /* box-shadow: var(--shadow-lg); */ /* Shadow might be on active panel instead */
    overflow: visible; /* Allow peeking panels if they are styled to do so */
    display: flex;
    flex-direction: column;
    height: 80vh; /* Example height, adjust as needed */
    min-height: 600px;
}

.checkout-header {
    padding: 25px 30px;
    background-color: rgba(0,0,0,0.3); /* Slightly transparent black */
    border-bottom: 1px solid var(--border-color);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.checkout-header .logo-placeholder {
    font-size: 1.8em;
    font-weight: 800;
    color: var(--text-primary);
    letter-spacing: 1px;
}

.progress-indicator {
    display: flex;
    gap: 10px;
}

.progress-indicator .step {
    color: var(--text-secondary);
    font-size: 0.9em;
    padding: 8px 12px;
    border-radius: var(--border-radius-sm);
    background-color: var(--surface-medium);
    border: 1px solid var(--border-color);
    transition: all var(--transition-speed) ease;
    display: flex;
    align-items: center;
    gap: 8px;
}
.progress-indicator .step span {
    background-color: var(--text-placeholder);
    color: var(--surface-dark);
    border-radius: 50%;
    width: 20px;
    height: 20px;
    display: inline-flex;
    justify-content: center;
    align-items: center;
    font-weight: 600;
    font-size: 0.8em;
    transition: all var(--transition-speed) ease;
}

.progress-indicator .step.active {
    color: var(--text-primary);
    background-color: var(--primary-color);
    border-color: var(--primary-color);
    font-weight: 600;
}
.progress-indicator .step.active span {
    background-color: var(--text-primary);
    color: var(--primary-color);
}
.progress-indicator .step.completed {
    color: var(--text-secondary);
    background-color: var(--surface-light);
    border-color: var(--success-color);
}
.progress-indicator .step.completed span {
    background-color: var(--success-color);
    color: var(--text-primary);
}


.checkout-main {
    flex-grow: 1;
    position: relative;
    display: flex;
    align-items: center;
    overflow: hidden; /* This will clip the non-active parts of panel-container */
}

.panel-container {
    display: flex;
    /* Width is 100% * number of panels. JS will set this if dynamic, or hardcode if fixed. */
    /* For 3 panels, if active is 70%, sides 15% each, total viewport is 100%.
       The container itself needs to be wide enough to hold all original-sized panels.
       Let's assume each panel *slot* is 100% of checkout-main width.
    */
    width: 300%; /* For 3 panels, each occupying a 100% slot */
    height: 100%;
    transition: transform 0.6s cubic-bezier(0.25, 0.8, 0.25, 1);
    will-change: transform;
}

.panel {
    width: calc(100% / 3); /* Each panel occupies one-third of the panel-container's total width */
    height: 100%;
    padding: 20px; /* Reduced padding for more content space */
    box-sizing: border-box;
    background-color: var(--surface-dark);
    border-radius: var(--border-radius-lg);
    box-shadow: var(--shadow-md);
    
    display: flex;
    flex-direction: column;

    /* Styles for inactive panels */
    opacity: 0.5;
    transform: scale(0.85);
    transition: opacity 0.6s ease, transform 0.6s ease;
    margin: 0 10px; /* Spacing between panels when scaled down */
    overflow-y: auto; /* Allow content scrolling within panel */
}

.panel.active {
    opacity: 1;
    transform: scale(1);
    z-index: 10; /* Ensure active panel is on top */
    box-shadow: var(--shadow-lg); /* More prominent shadow for active */
    margin: 0 2.5%; /* Adjust margin for active panel to control peeking of others */
                     /* This effectively makes the active panel take ~95% of its slot,
                        allowing a bit of the next/prev to show if their scale/margin allows.
                        The actual "peeking" is controlled by the panel-container's translateX
                        and the checkout-main's overflow:hidden.
                     */
}

/* Specific styling for panels to the immediate left/right of active (optional, for finer control) */
.panel.prev-adjacent, .panel.next-adjacent {
    opacity: 0.7;
    transform: scale(0.9);
    z-index: 5;
}

.panel-header {
    margin-bottom: 30px;
    padding-bottom: 15px;
    border-bottom: 1px solid var(--border-color);
}

.panel-header h2 {
    font-size: 2em;
    font-weight: 700;
    color: var(--text-primary);
    margin: 0 0 5px 0;
}
.panel-header h2 .step-number {
    color: var(--primary-color);
    font-weight: 800;
}

.panel-header p {
    font-size: 1em;
    color: var(--text-secondary);
    margin: 0;
}

.panel-content {
    /* Styles for content within panels */
}

/* Panel 1: Choose PC */
#panel-1 .panel-content {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 25px;
}

.option-card {
    background-color: var(--surface-medium);
    border-radius: var(--border-radius-md);
    padding: 20px;
    border: 1px solid var(--border-color);
    transition: all var(--transition-speed) ease;
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
}
.option-card:hover {
    border-color: var(--primary-color);
    background-color: var(--surface-light); /* Subtle background change on hover */
    box-shadow: var(--shadow-sm); /* Softer shadow */
}
.option-card.selected {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 2px var(--primary-color); /* Simpler outline shadow */
    background-color: var(--surface-light);
}

.option-card img {
    width: 100%;
    max-height: 180px;
    object-fit: cover;
    border-radius: var(--border-radius-sm);
    margin-bottom: 15px;
    background-color: var(--background-dark); /* Placeholder bg */
}

.option-card h3 {
    font-size: 1.4em;
    font-weight: 600;
    color: var(--text-primary);
    margin: 0 0 10px 0;
}

.option-card p {
    font-size: 0.95em;
    color: var(--text-secondary);
    margin-bottom: 10px;
    flex-grow: 1;
}
.option-card .price {
    font-size: 1.3em;
    font-weight: 700;
    color: var(--primary-color);
    margin-bottom: 15px;
}

.select-button, .next-step-btn, .prev-step-btn, .checkout-button {
    padding: 12px 25px;
    font-size: 1em;
    font-weight: 600;
    border-radius: var(--border-radius-sm);
    cursor: pointer;
    transition: all var(--transition-speed) ease;
    border: none;
    text-align: center;
}

.select-button {
    background-color: var(--primary-color);
    color: var(--text-primary);
    width: 100%;
}
.select-button:hover {
    background-color: var(--primary-hover);
}
.option-card.selected .select-button {
    background-color: var(--success-color);
    /* content: "Selected"; Removed as it's better handled by JS if text needs to change */
}


/* Panel 2: Choose Design - Redesigned Layout */
#panel-2 .panel-content {
    display: flex; /* Changed from grid to flex */
    gap: 20px;
    height: 100%; /* Ensure it fills the panel */
    flex-grow: 1;
}

.design-preview-area {
    flex: 2; /* Takes 2/3 of the space */
    background-color: var(--background-dark); /* Placeholder background */
    border-radius: var(--border-radius-md);
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    padding: 20px;
    border: 1px solid var(--border-color);
    min-height: 300px; /* Minimum height for the preview */
}
.design-preview-area #pcModelPreview { /* Placeholder for PC model image */
    max-width: 100%;
    max-height: 70%; /* Adjust as needed */
    object-fit: contain;
    margin-bottom: 10px;
}
.design-preview-area #artworkOnPcPreview { /* For the uploaded artwork */
    position: absolute; /* Will be positioned over the PC model */
    max-width: 50%; /* Example, JS will control this */
    max-height: 50%;
    /* Further styling for positioning and appearance */
}
.design-preview-area .preview-placeholder-text {
    color: var(--text-placeholder);
    font-size: 1.2em;
}


.design-controls-area {
    flex: 1; /* Takes 1/3 of the space */
    display: flex;
    flex-direction: column;
    gap: 20px;
    overflow-y: auto; /* Scroll if controls exceed height */
    padding-right: 10px; /* For scrollbar */
}

.design-option { /* Re-style for the new layout */
    background-color: var(--surface-medium);
    padding: 20px;
    border-radius: var(--border-radius-md);
    border: 1px solid var(--border-color);
}
.design-option h4 {
    font-size: 1.2em;
    color: var(--text-primary);
    margin-top: 0;
    margin-bottom: 10px;
}
.design-option p {
    color: var(--text-secondary);
    font-size: 0.9em;
    margin-bottom: 10px;
}

#artworkUpload { /* Style remains similar */
    display: block;
    width: 100%;
    padding: 10px;
    margin-bottom: 10px;
    background-color: var(--surface-light);
    border: 1px dashed var(--border-color);
    color: var(--text-primary);
    border-radius: var(--border-radius-sm);
    font-family: var(--font-main);
}
#artworkUpload:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0 0 0 2px var(--primary-color);
}

/* Artwork tools (placeholder) */
.artwork-tools {
    margin-top: 10px;
}
.artwork-tools button {
    background-color: var(--surface-light);
    color: var(--text-primary);
    border: 1px solid var(--border-color);
    padding: 8px 12px;
    border-radius: var(--border-radius-sm);
    cursor: pointer;
    margin-right: 10px;
    font-size: 0.9em;
}
.artwork-tools button:hover {
    border-color: var(--primary-color);
}


.gallery-grid { /* Style remains similar, but within design-controls-area */
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); /* Smaller items */
    gap: 10px;
}
.gallery-item {
    background-color: var(--surface-light);
    border-radius: var(--border-radius-sm);
    padding: 8px;
    text-align: center;
    cursor: pointer;
    border: 2px solid transparent;
    transition: all var(--transition-speed) ease;
}
.gallery-item:hover {
    border-color: var(--primary-color);
    background-color: var(--background-dark);
}
.gallery-item.selected {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 2px var(--primary-color);
    background-color: var(--surface-light);
}
.gallery-item.selected p {
    color: var(--primary-color);
    font-weight: 600;
}
.gallery-item img {
    width: 100%;
    height: 60px; /* Smaller images */
    object-fit: cover;
    border-radius: var(--border-radius-sm);
    margin-bottom: 5px;
}
.gallery-item p {
    font-size: 0.8em;
    color: var(--text-secondary);
    margin: 0;
    transition: color var(--transition-speed) ease;
}
#selectedDesignName {
    color: var(--primary-color);
    font-weight: 600;
    margin-top:10px;
    display: block;
}

/* Panel 3: Summary */
.summary-details {
    background-color: var(--surface-medium);
    padding: 25px;
    border-radius: var(--border-radius-md);
    margin-bottom: 30px;
    border: 1px solid var(--border-color);
}
.summary-details h3 {
    font-size: 1.6em;
    color: var(--text-primary);
    margin-top: 0;
    margin-bottom: 20px;
    padding-bottom: 10px;
    border-bottom: 1px solid var(--border-color);
}
.summary-details h4 {
    font-size: 1.1em;
    color: var(--primary-color);
    margin-top: 0;
    margin-bottom: 8px;
}
.summary-details p {
    color: var(--text-secondary);
    margin-bottom: 5px;
}
.summary-details p span {
    color: var(--text-primary);
    font-weight: 500;
}
#summaryDesignSelection, #summaryPcSelection {
    margin-bottom: 20px;
}
#summaryDesignImage {
    border-radius: var(--border-radius-sm);
    border: 1px solid var(--border-color);
    background-color: var(--background-dark);
}
.total-price {
    margin-top: 20px;
    padding-top: 20px;
    border-top: 1px solid var(--border-color);
}
.total-price h4 {
    font-size: 1.8em;
    color: var(--text-primary);
    text-align: right;
}
.total-price h4 span {
    color: var(--primary-color);
    font-weight: 700;
}

.checkout-button {
    background-color: var(--success-color);
    color: var(--text-primary);
    width: 100%;
    padding: 15px 25px;
    font-size: 1.2em;
}
.checkout-button:hover {
    background-color: #28a745; /* Darker green */
}

/* Panel Navigation */
.panel-navigation {
    margin-top: 30px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding-top: 20px;
    border-top: 1px solid var(--border-color);
}

.next-step-btn {
    background-color: var(--primary-color);
    color: var(--text-primary);
}
.next-step-btn:hover {
    background-color: var(--primary-hover);
}
.next-step-btn:disabled {
    background-color: var(--surface-light);
    color: var(--text-placeholder);
    cursor: not-allowed;
}

.prev-step-btn {
    background-color: transparent;
    color: var(--primary-color);
    border: 2px solid var(--primary-color);
}
.prev-step-btn:hover {
    background-color: var(--primary-color);
    color: var(--text-primary);
}

/* Responsive Adjustments */
@media (max-width: 768px) {
    body {
        padding-top: 0;
        padding-bottom: 0;
        align-items: stretch; /* Full height on mobile */
    }
    .checkout-container {
        width: 100%;
        height: 100%;
        border-radius: 0;
        max-width: none;
    }
    .checkout-header {
        flex-direction: column;
        gap: 15px;
        padding: 20px;
    }
    .progress-indicator {
        flex-wrap: wrap;
        justify-content: center;
    }
    .progress-indicator .step {
        font-size: 0.8em;
        padding: 6px 10px;
    }
    .panel {
        padding: 20px;
        min-height: calc(100vh - 150px); /* Adjust based on header height */
    }
    .panel-header h2 {
        font-size: 1.6em;
    }
    #panel-1 .panel-content {
        grid-template-columns: 1fr; /* Stack cards on mobile */
    }
    .panel-navigation {
        flex-direction: column-reverse; /* Stack buttons */
        gap: 15px;
    }
    .next-step-btn, .prev-step-btn, .checkout-button {
        width: 100%;
    }
}

@media (max-width: 480px) {
    .checkout-header .logo-placeholder {
        font-size: 1.5em;
    }
    .progress-indicator .step {
        font-size: 0.7em; /* Further reduce for very small screens */
        gap: 5px;
    }
    .progress-indicator .step span {
        width: 18px;
        height: 18px;
        font-size: 0.7em;
    }
    .panel-header h2 {
        font-size: 1.4em;
    }
    .panel-header p {
        font-size: 0.9em;
    }
}
    </style>
</head>
<body>
    <div class="checkout-container">
        <header class="checkout-header">
            <div class="logo-placeholder">AFTERSHOCK CHECKOUT</div>
            <div class="progress-indicator">
                <div class="step active" id="step-indicator-1"><span>1</span> Choose PC</div>
                <div class="step" id="step-indicator-2"><span>2</span> Choose Design</div>
                <div class="step" id="step-indicator-3"><span>3</span> Summary & Pay</div>
            </div>
        </header>

        <main class="checkout-main">
            <div class="panel-container">
                <!-- Panel 1: Choose PC -->
                <section id="panel-1" class="panel active">
                    <div class="panel-header">
                        <h2><span class="step-number">Step 1:</span> Choose Your PC</h2>
                        <p>Select the base model or configuration that suits your needs.</p>
                    </div>
                    <div class="panel-content">
                        <!-- PC Options will go here -->
                        <div class="option-card">
                            <img src="https://via.placeholder.com/300x200/2a2a2a/ffffff?text=Base+Gaming+PC" alt="Base Gaming PC">
                            <h3>Starter Custom Rig</h3>
                            <p>Balanced performance for everyday gaming and productivity.</p>
                            <p class="price">$1,499 AUD</p>
                            <button class="select-button" data-pc-name="Starter Custom Rig" data-pc-price="1499">Select This PC</button>
                        </div>
                        <div class="option-card">
                            <img src="https://via.placeholder.com/300x200/2a2a2a/ffffff?text=Pro+Gamer+PC" alt="Pro Gamer PC">
                            <h3>Pro Gamer Custom</h3>
                            <p>High-end components for serious 1440p/4K gaming.</p>
                            <p class="price">$2,499 AUD</p>
                            <button class="select-button" data-pc-name="Pro Gamer Custom" data-pc-price="2499">Select This PC</button>
                        </div>
                        <div class="option-card">
                            <img src="https://via.placeholder.com/300x200/2a2a2a/ffffff?text=Ultra+Creative+PC" alt="Ultra Creative PC">
                            <h3>Ultra Creative Custom</h3>
                            <p>Top-tier power for demanding creative workloads.</p>
                            <p class="price">$3,999 AUD</p>
                            <button class="select-button" data-pc-name="Ultra Creative Custom" data-pc-price="3999">Select This PC</button>
                        </div>
                    </div>
                    <div class="panel-navigation">
                        <button class="next-step-btn" data-next-panel="panel-2" disabled>Next: Choose Design</button>
                    </div>
                </section>

                <!-- Panel 2: Choose Design -->
                <section id="panel-2" class="panel">
                    <div class="panel-header">
                        <h2><span class="step-number">Step 2:</span> Choose Your Design</h2>
                        <p>Personalize your PC with custom artwork or select from our gallery.</p>
                    </div>
                    <div class="panel-content">
                        <div class="design-preview-area">
                            <!-- PC Model Image (placeholder or actual) -->
                            <img id="pcModelPreview" src="https://via.placeholder.com/400x300/1a1a1c/3a3a3c?text=PC+Model+Preview" alt="PC Model Preview Area">
                            <!-- Uploaded/Selected Artwork will be overlaid here by JS -->
                            <img id="artworkOnPcPreview" src="#" alt="Artwork on PC" style="display:none;">
                            <span class="preview-placeholder-text" id="pcPreviewPlaceholderText">Your Design on PC Here</span>
                        </div>
                        <div class="design-controls-area">
                            <div class="design-option">
                                <h4>Upload Your Own Artwork</h4>
                                <p>Max 10MB. JPG/PNG. 300 DPI recommended.</p>
                                <input type="file" id="artworkUpload" accept="image/jpeg, image/png">
                                <div id="artworkPreviewContainer" style="margin-top:10px; min-height:100px; background-color: var(--background-dark); border-radius: var(--border-radius-sm); display: flex; justify-content: center; align-items: center; border: 1px solid var(--border-color);">
                                    <img id="artworkPreview" src="#" alt="Uploaded Artwork Thumbnail" style="display:none; max-width:100%; max-height:100px;">
                                    <span id="artworkPreviewText">Upload Preview</span>
                                </div>
                                <div class="artwork-tools">
                                     <button id="cropBtn" style="display:none;">Crop</button>
                                     <button id="rotateBtn" style="display:none;">Rotate</button>
                                     <!-- Add more tool buttons as needed -->
                                </div>
                            </div>
                            <div class="design-option">
                                <h4>Or Choose from Gallery</h4>
                                <div class="gallery-grid">
                                    <div class="gallery-item" data-design-name="Red Cyberpunk" data-design-image="https://images.prismic.io/aftershockpc/ZtVccEaF0TcGJp7v_HERO_RedCyberpunk.png?auto=format,compress">
                                        <img src="https://cdn.shopify.com/s/files/1/0532/3266/4731/files/crimson.png?v=1725261837&width=150" alt="Red Cyberpunk">
                                        <p>Red Cyberpunk</p>
                                    </div>
                                    <div class="gallery-item" data-design-name="Blue Leaves" data-design-image="https://images.prismic.io/aftershockpc/ZuDsMhoQrfVKl8T4_HERO_BlueLeaves.png?auto=format,compress">
                                        <img src="https://cdn.shopify.com/s/files/1/0532/3266/4731/files/blue_20leaves.png?v=1726035983&width=150" alt="Blue Leaves">
                                        <p>Blue Leaves</p>
                                    </div>
                                    <div class="gallery-item" data-design-name="Blue Gundam" data-design-image="https://images.prismic.io/aftershockpc/ZuEinxoQrfVKl8dA_HERO_BlueGundam-1-.png?auto=format,compress">
                                        <img src="https://cdn.shopify.com/s/files/1/0532/3266/4731/files/gundam_201.png?v=1726035974&width=150" alt="Blue Gundam">
                                        <p>Blue Gundam</p>
                                    </div>
                                     <div class="gallery-item" data-design-name="No Custom Design" data-design-image="">
                                        <img src="https://via.placeholder.com/150x100/2a2a2a/ffffff?text=No+Design" alt="No Custom Design">
                                        <p>No Custom Design</p>
                                    </div>
                                </div>
                            </div>
                            <p>Selected Design: <strong id="selectedDesignName">None</strong></p>
                        </div>
                    </div>
                    <div class="panel-navigation">
                        <button class="prev-step-btn" data-prev-panel="panel-1">Back: Choose PC</button>
                        <button class="next-step-btn" data-next-panel="panel-3">Next: Summary</button>
                    </div>
                </section>

                <!-- Panel 3: Summary + Checkout -->
                <section id="panel-3" class="panel">
                    <div class="panel-header">
                        <h2><span class="step-number">Step 3:</span> Summary & Checkout</h2>
                        <p>Review your selections and proceed to payment.</p>
                    </div>
                    <div class="panel-content">
                        <div class="summary-details">
                            <h3>Order Summary</h3>
                            <div id="summaryPcSelection">
                                <h4>Selected PC:</h4>
                                <p>Name: <span id="summaryPcName">N/A</span></p>
                                <p>Price: $<span id="summaryPcPrice">0.00</span> AUD</p>
                            </div>
                            <div id="summaryDesignSelection">
                                <h4>Selected Design:</h4>
                                <p>Name: <span id="summaryDesignName">N/A</span></p>
                                <img id="summaryDesignImage" src="#" alt="Selected Design Preview" style="max-width: 200px; max-height: 150px; margin-top: 10px; display: none;">
                            </div>
                            <hr>
                            <div class="total-price">
                                <h4>Total: $<span id="summaryTotalPrice">0.00</span> AUD</h4>
                            </div>
                        </div>
                        <button class="checkout-button">Proceed to Checkout</button>
                    </div>
                    <div class="panel-navigation">
                        <button class="prev-step-btn" data-prev-panel="panel-2">Back: Choose Design</button>
                    </div>
                </section>
            </div>
        </main>
    </div>
    <script>
    (function () {
        const panelContainer = document.querySelector('.panel-container');
        const panels = document.querySelectorAll('.panel');
        const nextButtons = document.querySelectorAll('.next-step-btn');
        const prevButtons = document.querySelectorAll('.prev-step-btn');
        const progressSteps = document.querySelectorAll('.progress-indicator .step');

        const pcSelectionButtons = document.querySelectorAll('#panel-1 .select-button');
        const artworkUploadInput = document.getElementById('artworkUpload');
        const artworkPreview = document.getElementById('artworkPreview'); // Thumbnail preview
        const artworkPreviewText = document.getElementById('artworkPreviewText'); // Text for thumbnail
        const artworkOnPcPreview = document.getElementById('artworkOnPcPreview'); // Main preview on PC model
        const pcPreviewPlaceholderText = document.getElementById('pcPreviewPlaceholderText'); // Text for main PC preview
        const galleryItems = document.querySelectorAll('#panel-2 .gallery-item');

        const summaryPcName = document.getElementById('summaryPcName');
        const summaryPcPrice = document.getElementById('summaryPcPrice');
        const summaryDesignName = document.getElementById('summaryDesignName');
        const summaryDesignImage = document.getElementById('summaryDesignImage');
        const summaryTotalPrice = document.getElementById('summaryTotalPrice');

        const checkoutButton = document.querySelector('.checkout-button');

        let currentPanel = 0;
        let orderDetails = {
            pc: null, // { name: 'Starter Custom Rig', price: 1499 }
            design: null // { name: 'Red Cyberpunk', image: 'url' } or { name: 'Custom Upload', image: 'dataURL' }
        };

        function updatePanelVisibility() {
            if (!panelContainer || !panels.length) return;

            const panelWidthPercentage = 100 / panels.length; // Each panel's slot in the container
            // Calculate the offset to center the active panel.
            // This needs to account for the fact that the panel-container itself moves.
            // The active panel should appear in the "center" of the checkout-main viewport.
            // If each panel slot is 100% of checkout-main's width:
            let offsetPercentage = -currentPanel * panelWidthPercentage;

            panelContainer.style.transform = `translateX(${offsetPercentage}%)`;

            panels.forEach((panel, index) => {
                panel.classList.remove('active', 'prev-adjacent', 'next-adjacent');
                if (index === currentPanel) {
                    panel.classList.add('active');
                } else if (index === currentPanel - 1) {
                    panel.classList.add('prev-adjacent');
                } else if (index === currentPanel + 1) {
                    panel.classList.add('next-adjacent');
                }
            });

            progressSteps.forEach((step, index) => {
                step.classList.remove('active', 'completed');
                if (index < currentPanel) {
                    step.classList.add('completed');
                } else if (index === currentPanel) {
                    step.classList.add('active');
                }
            });
        }

        function updateSummary() {
            let total = 0;
            if (orderDetails.pc) {
                summaryPcName.textContent = orderDetails.pc.name;
                summaryPcPrice.textContent = parseFloat(orderDetails.pc.price).toFixed(2);
                total += parseFloat(orderDetails.pc.price);
            } else {
                summaryPcName.textContent = 'N/A';
                summaryPcPrice.textContent = '0.00';
            }

            if (orderDetails.design && orderDetails.design.name !== "No Custom Design") {
                summaryDesignName.textContent = orderDetails.design.name;
                if(orderDetails.design.image && orderDetails.design.image !== "") {
                    summaryDesignImage.src = orderDetails.design.image;
                    summaryDesignImage.style.display = 'block';
                } else {
                    summaryDesignImage.style.display = 'none';
                }
            } else {
                summaryDesignName.textContent = 'No Custom Design (Included)';
                summaryDesignImage.style.display = 'none';
            }
            summaryTotalPrice.textContent = total.toFixed(2);
        }

        // Panel 1: PC Selection
        pcSelectionButtons.forEach(button => {
            button.addEventListener('click', () => {
                pcSelectionButtons.forEach(btn => btn.closest('.option-card').classList.remove('selected'));
                button.closest('.option-card').classList.add('selected');
                orderDetails.pc = {
                    name: button.dataset.pcName,
                    price: parseFloat(button.dataset.pcPrice)
                };
                const panel1NextBtn = document.querySelector('#panel-1 .next-step-btn');
                if (panel1NextBtn) {
                    panel1NextBtn.disabled = false;
                }
                updateSummary();
            });
        });

        // Panel 2: Design Selection
        if (artworkUploadInput) {
            artworkUploadInput.addEventListener('change', function(event) {
                const file = event.target.files[0];
                if (file) {
                    if (file.type === "image/jpeg" || file.type === "image/png") {
                        if (file.size <= 10 * 1024 * 1024) { // 10MB
                            const reader = new FileReader();
                            reader.onload = function(e) {
                                // Update thumbnail preview
                                artworkPreview.src = e.target.result;
                                artworkPreview.style.display = 'block';
                                artworkPreviewText.style.display = 'none';
                                
                                // Update main PC preview
                                if (artworkOnPcPreview) {
                                    artworkOnPcPreview.src = e.target.result;
                                    artworkOnPcPreview.style.display = 'block';
                                }
                                if (pcPreviewPlaceholderText) pcPreviewPlaceholderText.style.display = 'none';

                                orderDetails.design = { name: `Custom: ${file.name}`, image: e.target.result };
                                galleryItems.forEach(item => item.classList.remove('selected'));
                                document.getElementById('selectedDesignName').textContent = `Custom: ${file.name}`;
                                updateSummary();
                                // Show crop/rotate buttons for custom uploads
                                document.getElementById('cropBtn').style.display = 'inline-block';
                                document.getElementById('rotateBtn').style.display = 'inline-block';
                            }
                            reader.readAsDataURL(file);
                        } else {
                            alert("File is too large. Maximum size is 10MB.");
                            artworkPreview.src = "#"; artworkPreview.style.display = 'none'; artworkPreviewText.style.display = 'block';
                            if (artworkOnPcPreview) { artworkOnPcPreview.src = "#"; artworkOnPcPreview.style.display = 'none'; }
                            if (pcPreviewPlaceholderText) pcPreviewPlaceholderText.style.display = 'block';
                            artworkUploadInput.value = "";
                        }
                    } else {
                        alert("Invalid file type. Please upload JPG or PNG.");
                        artworkPreview.src = "#"; artworkPreview.style.display = 'none'; artworkPreviewText.style.display = 'block';
                        if (artworkOnPcPreview) { artworkOnPcPreview.src = "#"; artworkOnPcPreview.style.display = 'none'; }
                        if (pcPreviewPlaceholderText) pcPreviewPlaceholderText.style.display = 'block';
                        artworkUploadInput.value = "";
                    }
                }
            });
        }

        galleryItems.forEach(item => {
            item.addEventListener('click', () => {
                galleryItems.forEach(it => it.classList.remove('selected'));
                item.classList.add('selected');
                orderDetails.design = {
                    name: item.dataset.designName,
                    image: item.dataset.designImage
                };

                // Update thumbnail preview (if needed, or clear it)
                if (artworkPreview) { artworkPreview.src = "#"; artworkPreview.style.display = 'none'; }
                if (artworkPreviewText) artworkPreviewText.style.display = 'block'; // Show placeholder for upload thumbnail
                if (artworkUploadInput) artworkUploadInput.value = ""; // Clear file input

                // Update main PC preview
                if (artworkOnPcPreview) {
                    if (item.dataset.designImage && item.dataset.designImage !== "") {
                        artworkOnPcPreview.src = item.dataset.designImage;
                        artworkOnPcPreview.style.display = 'block';
                        if (pcPreviewPlaceholderText) pcPreviewPlaceholderText.style.display = 'none';
                    } else { // "No Custom Design" or empty image
                        artworkOnPcPreview.src = "#";
                        artworkOnPcPreview.style.display = 'none';
                        if (pcPreviewPlaceholderText) pcPreviewPlaceholderText.style.display = 'block';
                    }
                }
                
                document.getElementById('selectedDesignName').textContent = item.dataset.designName;
                updateSummary();
                // Hide crop/rotate buttons for gallery items
                document.getElementById('cropBtn').style.display = 'none';
                document.getElementById('rotateBtn').style.display = 'none';
            });
        });

        // Navigation
        nextButtons.forEach(button => {
            button.addEventListener('click', () => {
                if (currentPanel < panels.length - 1) {
                    if (currentPanel === 0 && !orderDetails.pc) {
                        alert("Please select a PC configuration to continue.");
                        return;
                    }
                    if (currentPanel === 1 && !orderDetails.design) {
                        alert("Please choose a design or select 'No Custom Design' to continue.");
                        return;
                    }
                    currentPanel++;
                    updatePanelVisibility();
                    if (currentPanel === panels.length - 1) {
                        updateSummary();
                    }
                }
            });
        });

        prevButtons.forEach(button => {
            button.addEventListener('click', () => {
                if (currentPanel > 0) {
                    currentPanel--;
                    updatePanelVisibility();
                }
            });
        });

        if (checkoutButton) {
            checkoutButton.addEventListener('click', () => {
                if (!orderDetails.pc) {
                    alert("Please complete PC selection (Step 1).");
                    currentPanel = 0;
                    updatePanelVisibility();
                    return;
                }
                if (!orderDetails.design) {
                    alert("Please complete design selection (Step 2).");
                    currentPanel = 1;
                    updatePanelVisibility();
                    return;
                }
                alert(`Checkout initiated!\nPC: ${orderDetails.pc.name} ($${orderDetails.pc.price})\nDesign: ${orderDetails.design.name}\nTotal: $${summaryTotalPrice.textContent} AUD`);
                console.log("Order Details:", orderDetails);
            });
        }

        // Initial setup calls
        updatePanelVisibility();
        const panel1NextBtn = document.querySelector('#panel-1 .next-step-btn');
        if (panel1NextBtn) {
            panel1NextBtn.disabled = true;
        }
        
        // Default design selection to "No Custom Design"
        const noDesignOption = document.querySelector('.gallery-item[data-design-name="No Custom Design"]');
        if (noDesignOption && !orderDetails.design) { // Check if design isn't already set (e.g. by custom upload)
             orderDetails.design = {
                name: noDesignOption.dataset.designName,
                image: noDesignOption.dataset.designImage
            };
            document.getElementById('selectedDesignName').textContent = noDesignOption.dataset.designName;
            noDesignOption.classList.add('selected'); // Visually select it
        }
        updateSummary(); // Initial summary update
    })();
    </script>
</body>
</html>
