<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Complete your custom PC order with our easy 3-step checkout process.">
    <title>Checkout - Custom PC | Aftershock</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
:root {
    --primary-color: #D90429; /* Aftershock Red */
    --primary-hover: #B00020; /* Darker Aftershock Red for hover */
    --background-dark: #0D0D0F; /* Very dark, almost black */
    --surface-dark: #1A1A1C; /* For panels and cards */
    --surface-medium: #2C2C2E; /* Slightly lighter elements */
    --surface-light: #3A3A3C; /* Hover states or subtle borders */
    --text-primary: #F5F5F7; /* Off-white for primary text */
    --text-secondary: #A0A0A5; /* Lighter gray for secondary text */
    --text-placeholder: #6E6E73;
    --border-color: #3A3A3C;
    --error-color: #FF3B30;
    --success-color: #34C759; 

    --font-main: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;

    --shadow-sm: 0 2px 8px rgba(0,0,0,0.3);
    --shadow-md: 0 6px 16px rgba(0,0,0,0.4);
    --shadow-lg: 0 12px 32px rgba(0,0,0,0.5);
    --border-radius-sm: 6px;
    --border-radius-md: 10px;
    --border-radius-lg: 16px;
    --transition-speed: 0.3s;
    --transition-speed-panel: 0.6s; /* For panel transitions */
    --easing-panel: cubic-bezier(0.4, 0, 0.2, 1); /* Smoother easing */
}

/* --- Core Fullscreen Layout --- */
html {
    height: 100%; /* Ensure html takes full height */
}
body {
    font-family: var(--font-main);
    margin: 0;
    padding: 0; /* No padding on body */
    background-color: var(--background-dark);
    color: var(--text-primary);
    line-height: 1.6;
    font-size: 16px;
    width: 100vw;
    height: 100vh;
    overflow: hidden; /* Prevent body scroll, panels will manage their own */
    display: flex; /* To make checkout-container fill if needed, though it's 100vw/vh */
    flex-direction: column;
}

.checkout-container {
    width: 100%;
    height: 100%;
    background-color: var(--background-dark);
    overflow: hidden;
    display: flex;
    flex-direction: column;
}

.checkout-header {
    padding: 20px 30px; 
    background-color: rgba(0,0,0,0.4); 
    border-bottom: 1px solid var(--border-color);
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-shrink: 0; 
    flex-wrap: wrap; 
    gap: 15px;
}

.checkout-header .logo-placeholder {
    font-size: 1.8em;
    font-weight: 800;
    color: var(--primary-color);
    letter-spacing: 1px;
    margin-right: auto; 
}

#fullscreen-button { 
    padding: 8px 12px;
    background-color: var(--primary-color);
    color: var(--text-primary);
    border: none;
    border-radius: var(--border-radius-sm);
    cursor: pointer;
    font-size: 0.9em;
    font-weight: 500;
    transition: background-color var(--transition-speed) ease;
    order: 1; 
}
#fullscreen-button:hover {
    background-color: var(--primary-hover);
}
html:fullscreen #fullscreen-button,
html:-webkit-full-screen #fullscreen-button,
html:-moz-full-screen #fullscreen-button,
html:-ms-fullscreen #fullscreen-button {
    display: none !important;
}

.progress-indicator {
    display: flex;
    gap: 10px;
    order: 2; 
}
.progress-indicator .step {
    color: var(--text-secondary);
    font-size: 0.9em;
    padding: 8px 12px;
    border-radius: var(--border-radius-sm);
    background-color: var(--surface-medium);
    border: 1px solid var(--border-color);
    transition: all var(--transition-speed) ease;
    display: flex;
    align-items: center;
    gap: 8px;
    cursor: pointer;
}
.progress-indicator .step span {
    background-color: var(--text-placeholder);
    color: var(--surface-dark);
    border-radius: 50%;
    width: 20px;
    height: 20px;
    display: inline-flex;
    justify-content: center;
    align-items: center;
    font-weight: 600;
    font-size: 0.8em;
    transition: all var(--transition-speed) ease;
}
.progress-indicator .step.active {
    color: var(--text-primary);
    background-color: var(--primary-color);
    border-color: var(--primary-color);
    font-weight: 600;
}
.progress-indicator .step.active span {
    background-color: var(--text-primary);
    color: var(--primary-color);
}
.progress-indicator .step.completed {
    color: var(--text-secondary);
    background-color: var(--surface-light);
    border-color: var(--success-color);
}
.progress-indicator .step.completed span {
    background-color: var(--success-color);
    color: var(--text-primary);
}

.checkout-main {
    flex-grow: 1;
    position: relative; 
    display: flex; 
    overflow: hidden; 
    background-color: var(--surface-dark);
}

.panel-container {
    width: 100%;
    height: 100%;
    position: relative; 
    overflow: hidden; 
}

.panel {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    padding: 30px; 
    box-sizing: border-box;
    background-color: var(--surface-dark); 
    
    display: flex;
    flex-direction: column;
    overflow: hidden; 

    opacity: 0;
    transform: translateX(100%); /* Default start: off-screen right for non-active panels */
    transition: opacity var(--transition-speed-panel) var(--easing-panel), 
                transform var(--transition-speed-panel) var(--easing-panel);
    pointer-events: none; /* Non-active panels don't intercept clicks */
}

.panel.active {
    opacity: 1;
    transform: translateX(0);
    pointer-events: auto;
    z-index: 10; 
}
.panel .panel-header { 
    margin-bottom: 25px;
    padding-bottom: 20px;
    border-bottom: 1px solid var(--border-color);
    flex-shrink: 0;
}
.panel .panel-header-collapsed-content { display: none !important; } 
.panel .panel-header-expanded-content { display: block !important; } 

.panel-header-expanded-content h2 {
    font-size: 2.2em; 
    font-weight: 700;
    color: var(--text-primary);
    margin: 0 0 5px 0;
}
.panel-header-expanded-content h2 .step-number-text {
    color: var(--primary-color);
    font-weight: 800;
}
.panel-header-expanded-content p {
    font-size: 1em;
    color: var(--text-secondary);
    margin: 0;
}

.panel .panel-content-wrapper {
    flex-grow: 1;
    overflow: hidden; 
    display: flex;
    flex-direction: column;
}

.panel .panel-content {
    flex-grow: 1;
    overflow-y: auto; 
    padding-right: 15px; 
}

@keyframes fadeInSlideUp {
    from { opacity: 0; transform: translateY(30px); }
    to { opacity: 1; transform: translateY(0); }
}

#panel-1.active .option-card {
    animation: fadeInSlideUp 0.5s var(--easing-panel) forwards;
    opacity: 0; 
}
#panel-1.active .option-card:nth-child(1) { animation-delay: 0.1s; }
#panel-1.active .option-card:nth-child(2) { animation-delay: 0.2s; }
#panel-1.active .option-card:nth-child(3) { animation-delay: 0.3s; }


#panel-1 .panel-content {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); 
    gap: 30px; 
}

.option-card {
    background-color: var(--surface-medium);
    border-radius: var(--border-radius-md);
    padding: 25px;
    border: 1px solid var(--border-color);
    transition: all var(--transition-speed) ease, transform 0.2s ease-out; 
    display: flex;
    flex-direction: column;
    text-align: center;
}
.option-card:hover {
    border-color: var(--primary-color);
    background-color: var(--surface-light);
    box-shadow: var(--shadow-md); 
    transform: translateY(-5px); 
}
.option-card.selected {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px var(--primary-color), var(--shadow-md); 
    background-color: var(--surface-light);
    transform: translateY(-5px);
}
.option-card img {
    width: 100%; height: 200px; object-fit: contain;
    border-radius: var(--border-radius-sm); margin-bottom: 20px;
    background-color: var(--surface-dark);
}
.option-card h3 { font-size: 1.5em; font-weight: 600; color: var(--text-primary); margin: 0 0 15px 0; }
.option-card .pc-specs {
    text-align: left; margin: 15px 0; font-size: 0.9em;
    color: var(--text-secondary); flex-grow: 1; line-height: 1.5;
}
.option-card .pc-specs h4 { font-size: 1.1em; color: var(--text-primary); margin-bottom: 10px; }
.option-card .pc-specs ul { list-style: none; padding-left: 0; margin: 0; }
.option-card .pc-specs ul li { margin-bottom: 6px; padding-left: 18px; position: relative; }
.option-card .pc-specs ul li::before {
    content: '•'; color: var(--primary-color); font-weight: bold;
    display: inline-block; position: absolute; left: 0; top: 0px;
}
.option-card .price { font-size: 1.4em; font-weight: 700; color: var(--primary-color); margin: 20px 0; }
.option-card .price .original-price { text-decoration: line-through; font-size: 0.8em; color: var(--text-secondary); }
.option-card .price .savings { color: var(--success-color); font-size: 0.8em; font-weight: 500; display: block; margin: 2px 0; }

.select-button, .next-step-btn, .prev-step-btn, .checkout-button {
    padding: 14px 28px; font-size: 1.05em; font-weight: 600;
    border-radius: var(--border-radius-sm); cursor: pointer;
    transition: all var(--transition-speed) ease; border: none;
    text-align: center; margin-top: auto;
}
.select-button { background-color: var(--primary-color); color: var(--text-primary); width: 100%; }
.select-button:hover { background-color: var(--primary-hover); }
.option-card.selected .select-button { background-color: var(--success-color); }

#panel-2.active .panel-content { display: flex; gap: 30px; height: 100%; }
.design-preview-area {
    flex: 3; background-color: var(--background-dark);
    border-radius: var(--border-radius-md); display: flex;
    justify-content: center; align-items: center;
    border: 1px solid var(--border-color); min-height: 300px;
    position: relative; overflow: hidden;
    transition: background-color var(--transition-speed) ease;
}
.design-preview-area #pcModelPreview, .design-preview-area #artworkOnPcPreview {
    max-width: 100%; max-height: 100%; object-fit: contain; display: none;
}
.design-preview-area #artworkOverlayContainer {
    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    display: flex; justify-content: center; align-items: center; overflow: hidden; z-index: 2;
}
.design-preview-area #artworkOnPcPreview { width: 100%; height: 100%; object-fit: cover; padding:0; transition: padding var(--transition-speed) ease; }
.design-preview-area .preview-placeholder-text {
    color: var(--text-placeholder); font-size: 1.3em; z-index: 3; position: absolute;
    text-align: center; padding: 20px;
}
.design-controls-area {
    flex: 2; display: flex; flex-direction: column; gap: 25px;
    overflow-y: auto; padding-right: 10px;
}
.design-option {
    background-color: var(--surface-medium); padding: 25px;
    border-radius: var(--border-radius-md); border: 1px solid var(--border-color);
}
.design-option h4 { font-size: 1.3em; color: var(--text-primary); margin:0 0 15px 0; }
.gallery-grid {
    display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); 
    gap: 15px;
}
.gallery-item {
    background-color: var(--surface-light); border-radius: var(--border-radius-sm);
    text-align: center; cursor: pointer; border: 2px solid transparent;
    transition: all var(--transition-speed) ease, transform 0.2s ease-out;
    display: flex; flex-direction: column; justify-content: space-between;
    overflow: hidden; padding-bottom: 8px;
}
.gallery-item:hover {
    border-color: var(--primary-color); background-color: var(--background-dark);
    transform: scale(1.03); 
}
.gallery-item.selected {
    border-color: var(--primary-color); box-shadow: 0 0 0 2px var(--primary-color);
    background-color: var(--surface-light); transform: scale(1.03);
}
.gallery-item.selected p { color: var(--primary-color); font-weight: 600; }
.gallery-item img {
    width: 100%; height: 100px; 
    object-fit: cover; background-color: var(--surface-dark);
}
.gallery-item[data-design-name="No Custom Design"] img { object-fit: contain; padding: 5px; }
.gallery-item p { font-size: 0.85em; color: var(--text-secondary); margin:0; padding: 8px 8px 0; margin-bottom: 4px; }
.gallery-item .design-item-price { font-size: 0.8em; line-height: 1.2; }
.gallery-item .current-design-price { color: var(--success-color); font-weight: 600; }
.gallery-item .original-design-price { text-decoration: line-through; color: var(--text-secondary); margin-left: 4px; }
#selectedDesignName { color: var(--primary-color); font-weight: 600; margin-top:15px; display: block; font-size: 1.1em; }

.summary-details {
    background-color: var(--surface-medium); padding: 30px;
    border-radius: var(--border-radius-md); margin-bottom: 30px;
    border: 1px solid var(--border-color);
}
.summary-details h3 {
    font-size: 1.8em; color: var(--text-primary); margin:0 0 25px 0;
    padding-bottom: 15px; border-bottom: 1px solid var(--border-color);
}
.summary-details h4 { font-size: 1.2em; color: var(--primary-color); margin:0 0 10px 0; }
.summary-details p { color: var(--text-secondary); margin-bottom: 8px; font-size: 1.05em;}
.summary-details p span { color: var(--text-primary); font-weight: 500; }
#summaryDesignSelection, #summaryPcSelection { margin-bottom: 25px; }
#summaryDesignPriceLine { font-size: 1em; }
#summaryDesignOriginalPrice { text-decoration:line-through; color:var(--text-secondary); font-size:0.9em; margin-left:5px; }
#summaryPcPriceDetails .current-price { margin-bottom: 5px; }
#summaryPcPriceDetails .original-price-info { font-size: 0.95em; line-height: 1.4; }
#summaryPcPriceDetails .original-price-value { text-decoration:line-through; color:var(--text-secondary); margin-right:8px; }
#summaryPcPriceDetails .savings-value { color:var(--success-color); font-weight:500; display:block; }
#summaryDesignImage {
    border-radius: var(--border-radius-sm); border: 1px solid var(--border-color);
    background-color: var(--background-dark); max-width: 250px; max-height: 180px;
    margin-top: 15px; display: none;
}
.total-price { margin-top: 25px; padding-top: 25px; border-top: 1px solid var(--border-color); }
.total-price h4 { font-size: 2em; color: var(--text-primary); text-align: right; }
.total-price h4 span { color: var(--primary-color); font-weight: 700; }
.checkout-button {
    background-color: var(--success-color); color: var(--text-primary); width: 100%;
    padding: 18px 30px; font-size: 1.3em; 
}
.checkout-button:hover { background-color: #28a745; }

.panel .panel-navigation {
    margin-top: auto; 
    padding-top: 25px;
    border-top: 1px solid var(--border-color);
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-shrink: 0; 
}
.next-step-btn { background-color: var(--primary-color); color: var(--text-primary); }
.next-step-btn:hover { background-color: var(--primary-hover); }
.next-step-btn:disabled { background-color: var(--surface-light); color: var(--text-placeholder); cursor: not-allowed; }
.prev-step-btn { background-color: transparent; color: var(--primary-color); border: 2px solid var(--primary-color); }
.prev-step-btn:hover { background-color: var(--primary-color); color: var(--text-primary); }

@media (max-width: 768px) {
    .checkout-header { padding: 15px 20px; flex-direction: column; align-items: stretch; }
    .checkout-header .logo-placeholder { margin-right: 0; text-align: center; margin-bottom: 10px; }
    #fullscreen-button { width: 100%; margin-bottom: 10px; order: 0; } 
    .progress-indicator { justify-content: center; width: 100%; order: 1;}
    .progress-indicator .step { font-size: 0.8em; padding: 6px 10px; }

    .panel { padding: 20px; }
    .panel-header-expanded-content h2 { font-size: 1.8em; }
    .panel-header-expanded-content p { font-size: 0.95em; }
    
    #panel-1 .panel-content { grid-template-columns: 1fr; gap: 20px; }
    .option-card { padding: 20px; }
    .option-card img { height: 160px; }

    #panel-2.active .panel-content { flex-direction: column; }
    .design-preview-area { min-height: 250px; flex: 1; } 
    .design-controls-area { flex: 1; } 
    .gallery-grid { grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); }
    .gallery-item img { height: 80px; }

    .panel .panel-navigation { flex-direction: column-reverse; gap: 15px; }
    .next-step-btn, .prev-step-btn, .checkout-button { width: 100%; }
}
@media (max-width: 480px) {
    .checkout-header .logo-placeholder { font-size: 1.5em; }
    .progress-indicator .step { font-size: 0.7em; gap: 5px; }
    .progress-indicator .step span { width: 18px; height: 18px; font-size: 0.7em; }
    
    .panel { padding: 15px; }
    .panel-header-expanded-content h2 { font-size: 1.6em; }
    .panel-header-expanded-content p { font-size: 0.9em; }
    .option-card .pc-specs { font-size: 0.85em; }
    .select-button, .next-step-btn, .prev-step-btn, .checkout-button { padding: 12px 20px; font-size: 1em;}
    .checkout-button { font-size: 1.1em; }
}
    </style>
</head>
<body>
    <div class="checkout-container">
        <header class="checkout-header">
            <div class="logo-placeholder">AFTERSHOCK CHECKOUT</div>
            <button id="fullscreen-button">Go Fullscreen</button>
            <div class="progress-indicator">
                <div class="step active" id="step-indicator-1"><span>1</span> Choose PC</div>
                <div class="step" id="step-indicator-2"><span>2</span> Choose Design</div>
                <div class="step" id="step-indicator-3"><span>3</span> Summary & Pay</div>
            </div>
        </header>

        <main class="checkout-main">
            <div class="panel-container">
                <!-- Panel 1: Choose PC -->
                <section id="panel-1" class="panel active" data-panel-index="0" data-position="current">
                    <div class="panel-header">
                        <div class="panel-header-expanded-content">
                            <h2><span class="step-number-text">Step 1:</span> Choose Your PC</h2>
                            <p>Select the base model or configuration that suits your needs.</p>
                        </div>
                    </div>
                    <div class="panel-content-wrapper">
                        <div class="panel-content">
                            <div class="option-card">
                                <img src="https://cdn.shopify.com/s/files/1/0522/3320/7988/files/GGBA16CMH16.jpg?v=1748407225" alt="Gigabyte A16 CMH 16 Laptop">
                                <h3>Gigabyte A16 CMH 16"</h3>
                                <div class="pc-specs">
                                    <h4>Key Specifications:</h4>
                                    <ul>
                                        <li>16.0“ 16x10 IPS WUXGA (1920x1200) 165Hz Display</li>
                                        <li>Intel Core i7 13620H Processor | 4.9 GHz | 10 Cores 16 Threads</li>
                                        <li>16GB (2x8GB) DDR5 5200MHz</li>
                                        <li>Nvidia Geforce RTX 4050 6GB GDDR6</li>
                                        <li>1TB M.2 NVMe PCIe 4.0 SSD</li>
                                        <li>76Whr Battery</li>
                                        <li>~2.2 KG</li>
                                        <li>Windows 11 Home 64 bit (Activated)</li>
                                    </ul>
                                </div>
                                <p class="price">$1,799.00 AUD</p>
                                <button class="select-button" data-pc-name="Gigabyte A16 CMH 16" data-pc-price="1799" data-pc-image-src="https://cdn.shopify.com/s/files/1/0522/3320/7988/files/GGBA16CMH16.jpg?v=1748407225">Select This PC</button>
                            </div>
                            <div class="option-card">
                                <img src="https://cdn.shopify.com/s/files/1/0522/3320/7988/files/GGBG6MF_f80ed243-4e24-42ae-b05a-dc23bc0862b5.jpg?v=1747208260" alt="Gigabyte G6 KF 16 Laptop">
                                <h3>Gigabyte G6 KF 16"</h3>
                                 <div class="pc-specs">
                                    <h4>Key Specifications:</h4>
                                    <ul>
                                        <li>16.0" FHD+ (1920x1200) 144Hz Display</li>
                                        <li>Intel Core i5 13500H Processor | 4.7 GHz | 12 Cores 16 Threads</li>
                                        <li>16GB (2x8GB) DDR4 3200MHz</li>
                                        <li>Nvidia Geforce RTX 4060 8GB GDDR6</li>
                                        <li>512GB M.2 NVMe PCIe 4.0 SSD</li>
                                        <li>54Whr Battery</li>
                                        <li>~2.0 KG</li>
                                        <li>Windows 11 Home 64 bit (Activated)</li>
                                    </ul>
                                </div>
                                <p class="price">
                                    <span class="original-price">$1,999.00</span>
                                    <span class="savings">You save $300.00</span>
                                    $1,699.00 AUD
                                </p>
                                <button class="select-button" 
                                        data-pc-name="Gigabyte G6 KF 16" 
                                        data-pc-price="1699" 
                                        data-pc-image-src="https://cdn.shopify.com/s/files/1/0522/3320/7988/files/GGBG6MF_f80ed243-4e24-42ae-b05a-dc23bc0862b5.jpg?v=1747208260"
                                        data-pc-original-price="1999.00"
                                        data-pc-savings="You save $300.00">Select This PC</button>
                            </div>
                        </div>
                        <div class="panel-navigation">
                            <button class="next-step-btn" data-target-panel-index="1" disabled>Next: Choose Design</button>
                        </div>
                    </div>
                </section>

                <section id="panel-2" class="panel" data-panel-index="1" data-position="right">
                     <div class="panel-header">
                        <div class="panel-header-expanded-content">
                            <h2><span class="step-number-text">Step 2:</span> Choose Your Design</h2>
                            <p>Personalize your PC by selecting from our gallery.</p>
                        </div>
                    </div>
                    <div class="panel-content-wrapper">
                        <div class="panel-content">
                            <div class="design-preview-area" id="designPreviewArea">
                                <img id="pcModelPreview" src="#" alt="Selected PC Preview">
                                <div id="artworkOverlayContainer">
                                    <img id="artworkOnPcPreview" src="#" alt="Custom Artwork Preview">
                                </div>
                                <span class="preview-placeholder-text" id="pcPreviewPlaceholderText">Select a PC in Step 1 to see a preview.</span>
                            </div>
                            <div class="design-controls-area">
                                <div class="design-option">
                                    <h4>Choose from Gallery</h4>
                                    <div class="gallery-grid">
                                        <div class="gallery-item" data-design-name="Endgame" data-design-image="https://cdn.shopify.com/s/files/1/0532/3266/4731/products/Endgame-LaptopPrint_104f7f0a-4756-4cbf-9fa3-76d3641673f0.png?v=1669768163">
                                            <img src="https://cdn.shopify.com/s/files/1/0532/3266/4731/products/Endgame-LaptopPrint_104f7f0a-4756-4cbf-9fa3-76d3641673f0.png?v=1669768163" alt="Endgame Design">
                                            <p>Endgame</p>
                                            <div class="design-item-price">
                                                <span class="current-design-price">+$0</span>
                                                <span class="original-design-price">$160</span>
                                            </div>
                                        </div>
                                        <div class="gallery-item" data-design-name="Koi Pond" data-design-image="https://cdn.shopify.com/s/files/1/0532/3266/4731/products/Koi-LaptopPrint.png?v=1669698824">
                                            <img src="https://cdn.shopify.com/s/files/1/0532/3266/4731/products/Koi-LaptopPrint.png?v=1669698824" alt="Koi Pond Design">
                                            <p>Koi Pond</p>
                                            <div class="design-item-price">
                                                <span class="current-design-price">+$0</span>
                                                <span class="original-design-price">$160</span>
                                            </div>
                                        </div>
                                        <div class="gallery-item" data-design-name="Lofi Girl" data-design-image="https://cdn.shopify.com/s/files/1/0532/3266/4731/products/LofiGirl-LaptopPrint.png?v=1669698748">
                                            <img src="https://cdn.shopify.com/s/files/1/0532/3266/4731/products/LofiGirl-LaptopPrint.png?v=1669698748" alt="Lofi Girl Design">
                                            <p>Lofi Girl</p>
                                            <div class="design-item-price">
                                                <span class="current-design-price">+$0</span>
                                                <span class="original-design-price">$160</span>
                                            </div>
                                        </div>
                                        <div class="gallery-item" data-design-name="Mech Fight" data-design-image="https://cdn.shopify.com/s/files/1/0532/3266/4731/products/Mecha-LaptopPrint.png?v=1669698777">
                                            <img src="https://cdn.shopify.com/s/files/1/0532/3266/4731/products/Mecha-LaptopPrint.png?v=1669698777" alt="Mech Fight Design">
                                            <p>Mech Fight</p>
                                            <div class="design-item-price">
                                                <span class="current-design-price">+$0</span>
                                                <span class="original-design-price">$160</span>
                                            </div>
                                        </div>
                                         <div class="gallery-item" data-design-name="No Custom Design" data-design-image=""> 
                                            <img src="https://cdn.shopify.com/s/files/1/0532/3266/4731/files/Icons_Laptop_20_White.png?v=1718273518" alt="No Custom Design">
                                            <p>No Custom Design</p>
                                        </div>
                                    </div>
                                </div>
                                <p>Selected Design: <strong id="selectedDesignName">None</strong></p>
                            </div>
                        </div>
                        <div class="panel-navigation">
                            <button class="prev-step-btn" data-target-panel-index="0">Back: Choose PC</button>
                            <button class="next-step-btn" data-target-panel-index="2">Next: Summary</button>
                        </div>
                    </div>
                </section>

                <section id="panel-3" class="panel" data-panel-index="2" data-position="right">
                     <div class="panel-header">
                        <div class="panel-header-expanded-content">
                            <h2><span class="step-number-text">Step 3:</span> Summary & Checkout</h2>
                            <p>Review your selections and proceed to payment.</p>
                        </div>
                    </div>
                    <div class="panel-content-wrapper">
                        <div class="panel-content">
                            <div class="summary-details">
                                <h3>Order Summary</h3>
                                <div id="summaryPcSelection">
                                    <h4>Selected PC:</h4>
                                    <p>Name: <span id="summaryPcName">N/A</span></p>
                                    <div id="summaryPcPriceDetails">
                                        <p class="current-price">Price: $<span id="summaryPcPrice">0.00</span> AUD</p>
                                        <div class="original-price-info" id="summaryPcOriginalPriceContainer" style="display:none;">
                                            <span class="original-price-value" id="summaryPcOriginalPriceTextValue"></span>
                                            <span class="savings-value" id="summaryPcSavingsTextValue"></span>
                                        </div>
                                    </div>
                                </div>
                                <div id="summaryDesignSelection">
                                    <h4>Selected Design:</h4>
                                    <p>Name: <span id="summaryDesignNameDisplay">N/A</span></p> 
                                    <p id="summaryDesignPriceLine" style="display: none;">
                                        Price: <span id="summaryDesignPriceValue">$0.00</span> AUD
                                        <span id="summaryDesignOriginalPrice"></span>
                                    </p>
                                    <img id="summaryDesignImage" src="#" alt="Selected Design Preview" style="max-width: 200px; max-height: 150px; margin-top: 10px; display: none;">
                                </div>
                                <hr>
                                <div class="total-price">
                                    <h4>Total: $<span id="summaryTotalPrice">0.00</span> AUD</h4>
                                </div>
                            </div>
                            <button class="checkout-button">Proceed to Checkout</button>
                        </div>
                        <div class="panel-navigation">
                            <button class="prev-step-btn" data-target-panel-index="1">Back: Choose Design</button>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>
    <script>
    (function () {
        const panels = Array.from(document.querySelectorAll('.panel'));
        const nextButtons = document.querySelectorAll('.next-step-btn');
        const prevButtons = document.querySelectorAll('.prev-step-btn');
        const progressSteps = document.querySelectorAll('.progress-indicator .step');

        const pcSelectionButtons = document.querySelectorAll('#panel-1 .select-button');
        
        const designPreviewArea = document.getElementById('designPreviewArea');
        const pcModelPreview = document.getElementById('pcModelPreview'); 
        const artworkOnPcPreview = document.getElementById('artworkOnPcPreview'); 
        const pcPreviewPlaceholderText = document.getElementById('pcPreviewPlaceholderText'); 
        const galleryItems = document.querySelectorAll('#panel-2 .gallery-item');
        const selectedDesignNameOutput = document.getElementById('selectedDesignName'); 

        const summaryPcName = document.getElementById('summaryPcName');
        const summaryPcPrice = document.getElementById('summaryPcPrice');
        const summaryDesignNameDisplay = document.getElementById('summaryDesignNameDisplay'); 
        const summaryDesignImage = document.getElementById('summaryDesignImage'); 
        const summaryTotalPrice = document.getElementById('summaryTotalPrice');
        
        const summaryDesignPriceLine = document.getElementById('summaryDesignPriceLine');
        const summaryDesignPriceValue = document.getElementById('summaryDesignPriceValue');
        const summaryDesignOriginalPrice = document.getElementById('summaryDesignOriginalPrice');
        const summaryPcOriginalPriceContainer = document.getElementById('summaryPcOriginalPriceContainer');
        const summaryPcOriginalPriceTextValue = document.getElementById('summaryPcOriginalPriceTextValue');
        const summaryPcSavingsTextValue = document.getElementById('summaryPcSavingsTextValue');

        const checkoutButton = document.querySelector('.checkout-button');
        const PANEL_PRINT_ORIGINAL_PRICE = 160.00;
        const NO_DESIGN_ICON_URL = 'https://cdn.shopify.com/s/files/1/0532/3266/4731/files/Icons_Laptop_20_White.png?v=1718273518';

        const fullscreenButton = document.getElementById('fullscreen-button');
        const docEl = document.documentElement;

        let currentPanelIndex = 0; 
        let orderDetails = { pc: null, design: null };

        function setActivePanel(targetIndex, isInitialCall = false) {
            if (targetIndex < 0 || targetIndex >= panels.length) return;
            
            // If it's not the initial call and we are already on the target panel, do nothing.
            if (!isInitialCall && targetIndex === currentPanelIndex && panels[targetIndex].classList.contains('active')) {
                return;
            }

            // Validation checks
            if (!isInitialCall && targetIndex > currentPanelIndex) { // Moving forward
                if (currentPanelIndex === 0 && !orderDetails.pc) {
                    alert("Please select a PC configuration to continue.");
                    return;
                }
                if (currentPanelIndex === 1 && !orderDetails.design) {
                    const noDesignOption = document.querySelector('.gallery-item[data-design-name="No Custom Design"]');
                    if (noDesignOption) handleGallerySelection(noDesignOption);
                    if (!orderDetails.design) {
                        alert("Please choose a design or select 'No Custom Design' to continue.");
                        return;
                    }
                }
            }

            const oldActivePanel = panels[currentPanelIndex];
            const newActivePanel = panels[targetIndex];
            const movingForward = targetIndex > currentPanelIndex;

            // 1. Handle the outgoing panel (if it's not the initial call and there's a different old panel)
            if (!isInitialCall && oldActivePanel && oldActivePanel !== newActivePanel) {
                oldActivePanel.classList.remove('active'); 
                if (movingForward) {
                    oldActivePanel.style.transform = 'translateX(-100%)'; 
                    oldActivePanel.dataset.position = 'left';
                } else {
                    oldActivePanel.style.transform = 'translateX(100%)'; 
                    oldActivePanel.dataset.position = 'right';
                }
            }
            
            // 2. Handle the incoming panel
            if (newActivePanel) {
                // For the very first panel load, we just ensure it's styled correctly without transition.
                if (isInitialCall && targetIndex === 0) {
                    newActivePanel.style.transition = 'none';
                    newActivePanel.style.opacity = '1';
                    newActivePanel.style.transform = 'translateX(0)';
                    newActivePanel.classList.add('active'); // Ensure class is there
                    newActivePanel.dataset.position = 'current';
                     // Force reflow might be good even here to ensure styles apply before any subsequent transitions
                    void newActivePanel.offsetHeight;
                    newActivePanel.style.transition = ''; // Restore for future
                } else {
                    // Standard transition for other panels
                    newActivePanel.style.transition = 'none'; 
                    if (movingForward) {
                        newActivePanel.style.transform = 'translateX(100%)'; 
                    } else { 
                        newActivePanel.style.transform = 'translateX(-100%)'; 
                    }
                    newActivePanel.style.opacity = '0'; 
                    
                    void newActivePanel.offsetHeight; 
                    
                    newActivePanel.style.transition = ''; 
                    
                    requestAnimationFrame(() => {
                        newActivePanel.classList.add('active'); 
                        newActivePanel.dataset.position = 'current';
                    });
                }
            }
            
            currentPanelIndex = targetIndex;

            progressSteps.forEach((step, index) => {
                step.classList.remove('active', 'completed');
                if (index < currentPanelIndex) step.classList.add('completed');
                else if (index === currentPanelIndex) step.classList.add('active');
            });

            if (currentPanelIndex === panels.length - 1) updateSummary();
            if (currentPanelIndex === 1) updateDesignPreviewArea();
            
            if (newActivePanel) {
                const panelContent = newActivePanel.querySelector('.panel-content');
                if (panelContent) panelContent.scrollTop = 0;
            }
        }
        
        function updateDesignPreviewArea() { 
            pcModelPreview.style.display = 'none';
            artworkOnPcPreview.style.display = 'none';
            artworkOnPcPreview.style.objectFit = 'cover'; 
            artworkOnPcPreview.style.padding = '0';       
            designPreviewArea.style.backgroundColor = 'var(--background-dark)'; 

            if (!orderDetails.pc) {
                pcPreviewPlaceholderText.textContent = "Select a PC in Step 1 to see a preview.";
                pcPreviewPlaceholderText.style.display = 'block';
                return;
            }
            pcPreviewPlaceholderText.style.display = 'none';
            if (orderDetails.design && orderDetails.design.name === "No Custom Design") {
                artworkOnPcPreview.src = NO_DESIGN_ICON_URL;
                artworkOnPcPreview.style.objectFit = 'contain';
                artworkOnPcPreview.style.padding = '20px'; 
                artworkOnPcPreview.style.display = 'block';
                designPreviewArea.style.backgroundColor = 'var(--surface-medium)'; 
            } else if (orderDetails.design && orderDetails.design.image) {
                artworkOnPcPreview.src = orderDetails.design.image;
                artworkOnPcPreview.style.objectFit = 'cover'; 
                artworkOnPcPreview.style.display = 'block';
            } else {
                pcModelPreview.src = orderDetails.pc.imageSrc;
                pcModelPreview.style.display = 'block';
            }
        }

        function updateSummary() { 
            let total = 0;
            if (orderDetails.pc) {
                summaryPcName.textContent = orderDetails.pc.name;
                summaryPcPrice.textContent = parseFloat(orderDetails.pc.price).toFixed(2);
                total += parseFloat(orderDetails.pc.price);

                if (orderDetails.pc.originalPrice && orderDetails.pc.savingsText) {
                    summaryPcOriginalPriceTextValue.textContent = `$${orderDetails.pc.originalPrice.toFixed(2)}`;
                    summaryPcSavingsTextValue.textContent = orderDetails.pc.savingsText;
                    summaryPcOriginalPriceContainer.style.display = 'block';
                } else {
                    summaryPcOriginalPriceContainer.style.display = 'none';
                }
            } else {
                summaryPcName.textContent = 'N/A';
                summaryPcPrice.textContent = '0.00';
                summaryPcOriginalPriceContainer.style.display = 'none';
            }
            if (orderDetails.design) {
                summaryDesignNameDisplay.textContent = orderDetails.design.name;
                if (orderDetails.design.name !== "No Custom Design" && orderDetails.design.image && orderDetails.design.image !== "") {
                    summaryDesignImage.src = orderDetails.design.image;
                    summaryDesignImage.style.display = 'block';
                    summaryDesignPriceLine.style.display = 'block';
                    summaryDesignPriceValue.textContent = '$0.00';
                    summaryDesignOriginalPrice.textContent = `(was $${PANEL_PRINT_ORIGINAL_PRICE.toFixed(2)} AUD)`;
                } else {
                    summaryDesignImage.style.display = 'none';
                    summaryDesignPriceLine.style.display = 'none'; 
                    if (orderDetails.design.name === "No Custom Design") {
                         summaryDesignNameDisplay.textContent = 'No Custom Design'; 
                    }
                }
            } else {
                summaryDesignNameDisplay.textContent = 'N/A';
                summaryDesignImage.style.display = 'none';
                summaryDesignPriceLine.style.display = 'none';
            }
            summaryTotalPrice.textContent = total.toFixed(2);
        }

        pcSelectionButtons.forEach(button => {
            button.addEventListener('click', (event) => {
                event.stopPropagation();
                pcSelectionButtons.forEach(btn => btn.closest('.option-card').classList.remove('selected'));
                button.closest('.option-card').classList.add('selected');
                
                const pcImageSrc = button.dataset.pcImageSrc || button.closest('.option-card').querySelector('img').src;
                orderDetails.pc = {
                    name: button.dataset.pcName,
                    price: parseFloat(button.dataset.pcPrice),
                    imageSrc: pcImageSrc,
                    originalPrice: button.dataset.pcOriginalPrice ? parseFloat(button.dataset.pcOriginalPrice) : null,
                    savingsText: button.dataset.pcSavings || null
                };
                document.querySelector('#panel-1 .next-step-btn').disabled = false;
                updateSummary();
            });
        });

        function handleGallerySelection(item) { 
            galleryItems.forEach(it => it.classList.remove('selected'));
            item.classList.add('selected');
            
            const designName = item.dataset.designName;
            const designImage = item.dataset.designImage;
            orderDetails.design = { name: designName, image: designImage };
            
            if(selectedDesignNameOutput) selectedDesignNameOutput.textContent = designName;
            galleryItems.forEach(galleryItem => {
                const priceDiv = galleryItem.querySelector('.design-item-price');
                if (priceDiv) priceDiv.style.display = galleryItem.dataset.designName === "No Custom Design" ? 'none' : 'block';
            });
            updateDesignPreviewArea(); 
            updateSummary();
        }
        galleryItems.forEach(item => item.addEventListener('click', () => handleGallerySelection(item)));

        nextButtons.forEach(button => {
            button.addEventListener('click', (event) => {
                event.stopPropagation();
                setActivePanel(parseInt(button.dataset.targetPanelIndex));
            });
        });
        prevButtons.forEach(button => {
            button.addEventListener('click', (event) => {
                event.stopPropagation();
                setActivePanel(parseInt(button.dataset.targetPanelIndex));
            });
        });
        
        progressSteps.forEach((stepIndicator, index) => {
            stepIndicator.addEventListener('click', () => setActivePanel(index));
        });

        if (checkoutButton) { 
            checkoutButton.addEventListener('click', (event) => { 
                event.stopPropagation(); 
                if (!orderDetails.pc) {
                    alert("Please complete PC selection (Step 1).");
                    setActivePanel(0); return;
                }
                if (!orderDetails.design) {
                    const noDesignOption = document.querySelector('.gallery-item[data-design-name="No Custom Design"]');
                    if (noDesignOption) handleGallerySelection(noDesignOption);
                    else {
                        alert("Please complete design selection (Step 2).");
                        setActivePanel(1); return;
                    }
                }
                updateSummary();
                alert(`Checkout initiated!\nPC: ${orderDetails.pc.name} ($${parseFloat(orderDetails.pc.price).toFixed(2)})\nDesign: ${orderDetails.design.name}\nTotal: $${summaryTotalPrice.textContent} AUD`);
                console.log("Order Details:", orderDetails);
            });
        }

        if (fullscreenButton) {
            fullscreenButton.addEventListener('click', (event) => {
                event.stopPropagation();
                if (!document.fullscreenElement && !document.mozFullScreenElement && !document.webkitFullscreenElement && !document.msFullscreenElement) {
                    if (docEl.requestFullscreen) docEl.requestFullscreen();
                    else if (docEl.mozRequestFullScreen) docEl.mozRequestFullScreen();
                    else if (docEl.webkitRequestFullscreen) docEl.webkitRequestFullscreen();
                    else if (docEl.msRequestFullscreen) docEl.msRequestFullscreen();
                } else {
                    if (document.exitFullscreen) document.exitFullscreen();
                    else if (document.mozCancelFullScreen) document.mozCancelFullScreen();
                    else if (document.webkitExitFullscreen) document.webkitExitFullscreen();
                    else if (document.msExitFullscreen) document.msExitFullscreen();
                }
            });
            const updateFullscreenButtonText = () => {
                fullscreenButton.textContent = (!document.fullscreenElement && !document.mozFullScreenElement && !document.webkitFullscreenElement && !document.msFullscreenElement) ? 'Go Fullscreen' : 'Exit Fullscreen';
            };
            document.addEventListener('fullscreenchange', updateFullscreenButtonText);
            document.addEventListener('webkitfullscreenchange', updateFullscreenButtonText);
            document.addEventListener('mozfullscreenchange', updateFullscreenButtonText);
            document.addEventListener('MSFullscreenChange', updateFullscreenButtonText);
        }

        // Initial setup
        // Set initial state for non-active panels
        panels.forEach((panel, index) => {
            if (index !== 0) { // Panel 0 is active by HTML class
                panel.style.transform = 'translateX(100%)';
                panel.style.opacity = '0';
                panel.dataset.position = 'right'; // Their default off-screen position
            }
        });
        setActivePanel(0, true); // Pass true for isInitialCall
        
        document.querySelector('#panel-1 .next-step-btn').disabled = true;
        const noDesignOption = document.querySelector('.gallery-item[data-design-name="No Custom Design"]');
        if (noDesignOption) handleGallerySelection(noDesignOption);
        updateDesignPreviewArea();
        updateSummary();
    })();
    </script>
</body>
</html>